---
output:
  pdf_document: default
  html_document: default
---

# Homework Project 2A - 10 Kilobase Sequence Assembly

## BIOINFO M122/M222

### Due: Sunday May 12th, 2019, 11:59 pm

This programming assignment is designed to teach you about sequence assembly.

### Overview
In this assignment, you are given paired-end reads from an unknown donor sequence, and 10 percent of the reads are generated randomly to mimic contamination with another genetic source. These reads are formatted as two 50 bp-long ends, which are separated by a 90-110 bp-long separator. 

Your job will be to reconstruct contigs--the longest sequences of the donor that you are confident that you have assembled correctly. The output format is simple, and described on the cm124 site. The approximate length of the donor sequence is 10,000 bases.

### Starter Code

Starter code for the project is available at https://github.com/eeskin/CM122_starter_code. Use `git pull` in the CM122_starter_code repository you cloned to get the updated code, or you can just redownload the files directly from the link.
Tou should read the content of HP3, and see if you can understand what it is doing. You should also look to see where your input/output is going to go. This will generate an alignment file in the data folder from which it was executed.

## Tutorial

The starter code provided handles reading the reads and reference genome into Python lists, as well as converting a list of SNPs into the proper output format. You will be responsible for aligning the reads to the reference, and calling SNPs.

We are providing you with the skeleton for one script:
1. `basic_assembly.py` takes in a set of reads, an output file and an output header and outputs the contigs generated by assembly.

Running the above scripts with the `-h` option should be self explanatory, but here is an example of running them to create a file that can be submitted on the website for the 10K length genome practice data provided for project 2.

1. Download the 10K practice data from https://cm124.herokuapp.com/h2_data_files into the HP2 folder and unzip it. The commands below assume that you have a folder named practice_E_1 in the HP2 folder. If you download and save things in a different place you'll have to adjust the file paths below.

2. Use `basic_assembly.py` to align reads to the genome.

```
python basic_hasher.py -r practice_E_1/reads_practice_E_1_chr_1.txt \
-o test_output.txt -t practice_E_1_chr_1
```

This will generate a file of contigs in test_output.txt and a zipped version of that file formatted correctly for submission.

You can submit your results as many times as you want to achieve a passing score.

 

### I/O Details
https://cm124.herokuapp.com/ans_file_doc should handle most of your questions on reading and writing output.

### Spectrum

To generate the de Bruijn Graph, you need to first generate a spectrum from the reads; the spectrum is the set of shorter sequences present.  You will want to generate a spectrum with a sufficiently large number of bases, so that most of the sequences in the spectrum are not covered.

### de Bruijn Graph

The de Bruijn graph using a spectrum of size _k_ is by taking each read, and drawing a directed edge from the chunk of the read from position _j_ to position _j+k_, to the chunk from _j+1_ to position _j+k+1_ for all _j_. Some filtering of this graph needs to be done in the case that the errors have reads, and to filter out data from the "contaminating" sequence.

### Other Assembly Algorithms

There are other assembly algorithms (for example, an O(N^2^) greedy algorithm) that only work in easy cases. As this is an easy case, this algorithm will work (and in fact, it will likely work better than the deBruijn graph algorithm you are given starter code for), but it is not necessary to implement this algorithm to achieve a full-credit score.

### Grading

To obtain full credit you must obtain the following thresholds.

|           | Coverage | Accuracy | Contig Size |
|-----------|----------|----------|-------------|
| Undergrad | 87       | 43       | 5           |
| Grad      | 92       | 48       | 8           |
|           |          |          |             |
